---
import { getLangFromUrl } from "../i18n/utils"
import Button from "./Button.astro";

interface Props {
  post: {
    slug: string;
    data: {
      title: string;
      date: string;
      coverImg: string;
      altImg: string;
      description: string;
      tags?: string[];
    };
  };
}

const constructDate = (dateString: string): string => {
  const date = new Date(dateString);
  const options: Intl.DateTimeFormatOptions = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
  return date.toLocaleDateString(lang, options);
}

const { post } = Astro.props;

const lang = getLangFromUrl(Astro.url);

---

<div class="block border-2 border-primary rounded-2xl p-6">
  <h3 class="text-2xl">{post.data.title}</h3>
  <h5 class="text-secondary">{constructDate(post.data.date)}</h5>
  <img src={post.data.coverImg} alt={post.data.altImg} class="my-2 rounded-2xl aspect-video w-max object-cover">
  <p class="font-mono">{post.data.description}</p>
  <div class="grid mt-4 font-mono grid-cols-3 gap-2">
    <ul class="flex gap-2 text-secondary flex-wrap col-span-2">
      {post.data.tags?.map((tag) => (
        <li>{tag}</li>
      ))}
    </ul>
    <div class="flex justify-center">
      <Button
        href={`/${lang}/blog/${post.slug.split("/")[1]}`}
        icon="mingcute:link-line"
        target="_self"
      />
    </div>
  </div>
</div>